<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.collibra.com/apiv2">
  <collaboration id="Collaboration">
    <participant id="data_request_ticket_approval_workflow" name="Data Request Ticket Approval Workflow" processRef="data_request_ticket_approval"></participant>
  </collaboration>
  <process id="data_request_ticket_approval" name="Data Request Ticket Approval" isExecutable="true">
    <laneSet id="laneSet_data_request_ticket_approval">
      <lane id="lane1">
        <flowNodeRef>startevent1</flowNodeRef>
        <flowNodeRef>endevent1</flowNodeRef>
        <flowNodeRef>exclusivegateway1</flowNodeRef>
        <flowNodeRef>reset_status</flowNodeRef>
        <flowNodeRef>request_for_approval</flowNodeRef>
        <flowNodeRef>init_variables</flowNodeRef>
        <flowNodeRef>exclusivegateway2</flowNodeRef>
        <flowNodeRef>endevent2</flowNodeRef>
        <flowNodeRef>approved</flowNodeRef>
        <flowNodeRef>rejected_user_form</flowNodeRef>
        <flowNodeRef>data_access_granted</flowNodeRef>
        <flowNodeRef>dataSetRequestAccessGateway</flowNodeRef>
        <flowNodeRef>scripttask1</flowNodeRef>
        <flowNodeRef>parallelgateway1</flowNodeRef>
        <flowNodeRef>approved_user_form</flowNodeRef>
        <flowNodeRef>rejected</flowNodeRef>
        <flowNodeRef>Validate_with_request_for_approval</flowNodeRef>
        <flowNodeRef>exclusivegateway4</flowNodeRef>
        <flowNodeRef>extension_approved_user_form</flowNodeRef>
        <flowNodeRef>extension_rejected_user_form</flowNodeRef>
        <flowNodeRef>usertask1</flowNodeRef>
        <flowNodeRef>extend_approval1</flowNodeRef>
        <flowNodeRef>extend_approval</flowNodeRef>
        <flowNodeRef>extend_approval_3</flowNodeRef>
        <flowNodeRef>parallelgateway2</flowNodeRef>
        <flowNodeRef>exclusivegateway3</flowNodeRef>
        <flowNodeRef>endevent3</flowNodeRef>
      </lane>
    </laneSet>
    <startEvent id="startevent1" name="Start" activiti:initiator="requester">
      <extensionElements>
        <activiti:formProperty id="uuid_sensitive_data_obscured" name="Please fill in the UUID of the attribute sensitive data obscured" type="string" default="0b6269a2-dda8-445d-97dc-7c6519471607" readable="false" required="true"></activiti:formProperty>
        <activiti:formProperty id="uuid_dataset_approval_rejection_date" name="Please fill in the UUID of the attribute Dataset Approval / Rejection Date" type="string" default="66234855-9cf3-44ec-9c9c-89e84f0bea4a" readable="false" required="true"></activiti:formProperty>
        <activiti:formProperty id="add_access" name="add_access" type="string"></activiti:formProperty>
        <activiti:formProperty id="uuid_nr_of_extensions" name="Please fill in the UUID of the attribute Number of Data Request Extensions." type="string" default="a2e49066-4e8d-4a3d-9a85-0cd294e24b8e" readable="false" required="true"></activiti:formProperty>
        <activiti:formProperty id="pii_changed" name="pii_changed" type="string"></activiti:formProperty>
      </extensionElements>
    </startEvent>
    <endEvent id="endevent1" name="End"></endEvent>
    <scriptTask id="approved" name="Approved" scriptFormat="groovy" activiti:autoStoreVariables="false">
      <documentation>The Data Request Ticket has been approved; Access will be granted soon.</documentation>
      <script>import java.text.SimpleDateFormat
import java.time.LocalDate
import java.time.ZoneId
import com.collibra.dgc.core.api.dto.instance.asset.ChangeAssetRequest
import com.collibra.dgc.core.api.dto.instance.attribute.AddAttributeRequest
import com.collibra.dgc.core.api.dto.instance.attribute.FindAttributesRequest
import com.collibra.dgc.core.api.dto.instance.attribute.ChangeAttributeRequest


loggerApi.info("&lt;&lt;Access data request - approved: start")

assetApi.changeAsset(ChangeAssetRequest.builder()
							.id(newIssueUuid)
							.statusId(string2Uuid("00000000-0000-0000-0000-000000005025"))
							.build())

//approval/rejection date in the ticket
loggerApi.info("Init variables: Started")

def zoneId = ZoneId.of("UTC")
def currentDate = LocalDate.now()
def approval_date = currentDate.atStartOfDay(zoneId).toEpochSecond() * 1000

if(!attributeApi.findAttributes(FindAttributesRequest.builder()
										.assetId(newIssueUuid)
										.typeIds([string2Uuid(uuid_dataset_approval_rejection_date)])
										.build()
										).getResults().isEmpty())
		{
		def existingAttributeId = attributeApi.findAttributes(FindAttributesRequest.builder()
															.assetId(newIssueUuid)
															.typeIds([string2Uuid(uuid_dataset_approval_rejection_date)])
															.build()
															).getResults().get(0).getId()
			attributeApi.changeAttribute(ChangeAttributeRequest.builder()
						.id(existingAttributeId)
						.value(approval_date)
						.build())
			}
			else
			{
				attributeApi.addAttribute(AddAttributeRequest.builder()
												.assetId(newIssueUuid)
												.typeId(string2Uuid(uuid_dataset_approval_rejection_date))
												.value(approval_date)
												.build())
																
			}

															




loggerApi.info("&lt;&lt;Access data request - approved: end")
</script>
    </scriptTask>
    <exclusiveGateway id="exclusivegateway1" name="Exclusive Gateway"></exclusiveGateway>
    <userTask id="request_for_approval" name="Data Access Approval" activiti:async="true" activiti:candidateUsers="user(${dataOwner})">
      <documentation>&lt;span style="color: #ff0000;"&gt;${validation_message}&lt;/span&gt;&lt;br&gt;</documentation>
      <extensionElements>
        <activiti:formProperty id="rdb_option" name="${approval_message}" type="radiobox" required="true">
          <activiti:value id="Approved" name="Approved"></activiti:value>
          <activiti:value id="Rejected" name="Rejected"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="comment" name="Please fill in a comment, if you reject the request." type="textarea"></activiti:formProperty>
        <activiti:formProperty id="submit" name="Submit" type="button"></activiti:formProperty>
      </extensionElements>
    </userTask>
    <scriptTask id="reset_status" name="Reset Status" scriptFormat="groovy" activiti:autoStoreVariables="false">
      <script>import java.text.SimpleDateFormat
import java.time.LocalDate
import java.time.ZoneId
import com.collibra.dgc.core.api.dto.instance.attribute.FindAttributesRequest
import com.collibra.dgc.core.api.dto.instance.asset.ChangeAssetRequest
import com.collibra.dgc.core.api.dto.workflow.StartWorkflowInstancesRequest
import com.collibra.dgc.core.api.dto.instance.attribute.AddAttributeRequest

loggerApi.info("&lt;&lt;Reset Status: start")
//When Data Classification is General or Public, access can be given automatically, no approvals needed
def getAttributeValue(asset_uuid,attribute_uuid)
{
	def value = ""

	if(!attributeApi.findAttributes(FindAttributesRequest.builder()
											.assetId(asset_uuid)
											.typeIds([string2Uuid(attribute_uuid)])
											.build()
											).getResults().isEmpty())
		{
		value = attributeApi.findAttributes(FindAttributesRequest.builder()
												.assetId(asset_uuid)
												.typeIds([string2Uuid(attribute_uuid)])
												.build()
												).getResults().get(0).getValue()
				
		}
	return value
}
	
def dataclassification = getAttributeValue(assetApi.getAsset(dataset).getId(),"00000000-0000-0000-0001-000500000031")
def data_obscured = getAttributeValue(assetApi.getAsset(dataset).getId(),uuid_sensitive_data_obscured)//Sensitive Data Obscured
def data_pii = getAttributeValue(assetApi.getAsset(dataset).getId(),"00000000-0000-0000-0001-000500000029")
def approval_needed = false
execution.setVariable("approval_needed",false)

if (chk_pii != "" &amp;&amp; chk_pii != false)
{
	loggerApi.info("--chk_pii: " + chk_pii)
	
	//approval needed - status will become approval pending: 00000000-0000-0000-0000-000000005023
	assetApi.changeAsset(ChangeAssetRequest.builder()
		.id(newIssueUuid)
		.statusId(string2Uuid("00000000-0000-0000-0000-000000005023"))
		.build())
	
	approval_needed = true
	execution.setVariable("approval_needed",true)
}
else
{
	loggerApi.info("--add_access: " + add_access)

	
	if((dataclassification == "Confidential" &amp;&amp; data_obscured == false &amp;&amp; data_pii ==false)||
		(dataclassification == "Restricted" &amp;&amp; data_obscured == false &amp;&amp; data_pii ==true))
		{
		//approval needed - status will become approval pending: 00000000-0000-0000-0000-000000005023
		assetApi.changeAsset(ChangeAssetRequest.builder()
			.id(newIssueUuid)
			.statusId(string2Uuid("00000000-0000-0000-0000-000000005023"))
			.build())
		
		approval_needed = true
		execution.setVariable("approval_needed",true)
		
		}
	else
		{
		//Automatically approved
		assetApi.changeAsset(ChangeAssetRequest.builder()
			.id(newIssueUuid)
			.statusId(string2Uuid("00000000-0000-0000-0000-000000005025"))
			.build())
		
		
		//approval/rejection date in the ticket
		loggerApi.info("Init variables: Started")
		
		def zoneId = ZoneId.of("UTC")
		def currentDate = LocalDate.now()
		def approval_date = currentDate.atStartOfDay(zoneId).toEpochSecond() * 1000
		
		//Add an approval date only if it not yet exists
		if (add_access != "skip")
		{
			attributeApi.addAttribute(AddAttributeRequest.builder()
				.assetId(newIssueUuid)
				.typeId(string2Uuid(uuid_dataset_approval_rejection_date)) //Dataset Approval / Rejection Date
				.value(approval_date)
				.build())
		}
		
		}
}
	

loggerApi.info("&lt;&lt;Reset Status: end")
</script>
    </scriptTask>
    <scriptTask id="init_variables" name="Init Variables" scriptFormat="groovy" activiti:autoStoreVariables="false">
      <script>loggerApi.info("&lt;&lt;Init Variables: start")

def dataOwner_name = userApi.getUserByUsername(dataOwner).getFirstName() + " " + userApi.getUserByUsername(dataOwner).getLastName()
def dataset_name =  assetApi.getAsset(dataset).getName()
def dataset_uuid = assetApi.getAsset(dataset).getId()

def dataRequester_name = userApi.getUserByUsername(requester).getFirstName() + " " + userApi.getUserByUsername(requester).getLastName()
def approval_message = "Dear " + dataOwner_name + ",&lt;br&gt;&lt;br&gt;" + dataRequester_name + " requested access to the dataset &lt;b&gt;" + dataset_name + "&lt;/b&gt; (and access with PII).&lt;br&gt;Based on the information provided at the time of the request, this request requires your approval. Could you please either reject or approve this request and leave your comment below.&lt;br&gt;For more information, please click &lt;a href ='" + applicationApi.getInfo().getBaseUrl() + "asset/" + newIssueUuid + "' target='_blank'&gt;here&lt;/a&gt;&lt;br&gt;&lt;br&gt;Please approve or reject: &lt;br&gt;"
def validation_message = ""

execution.setVariable("dataOwner_name", dataOwner_name)
execution.setVariable("dataRequester_name", dataRequester_name)
execution.setVariable("dataset_name", dataset_name)
execution.setVariable("approval_message", approval_message)
execution.setVariable("validation_message", validation_message)
execution.setVariable("dataset_uuid", dataset_uuid)
execution.setVariable("pii_changed", "")



loggerApi.info("&lt;&lt;Init Variables: End")
</script>
    </scriptTask>
    <sequenceFlow id="flow11" sourceRef="startevent1" targetRef="init_variables"></sequenceFlow>
    <sequenceFlow id="flow12" sourceRef="init_variables" targetRef="reset_status"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway2" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow13" sourceRef="reset_status" targetRef="exclusivegateway2"></sequenceFlow>
    <sequenceFlow id="flow14" sourceRef="exclusivegateway2" targetRef="request_for_approval">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${approval_needed}]]></conditionExpression>
    </sequenceFlow>
    <endEvent id="endevent2" name="End"></endEvent>
    <sequenceFlow id="flow18" sourceRef="exclusivegateway1" targetRef="approved">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${rdb_option=="Approved" && validation_message == ""}]]></conditionExpression>
    </sequenceFlow>
    <userTask id="rejected_user_form" name="Data Request Rejected" activiti:candidateUsers="user(${requester})">
      <documentation>Dear ${dataRequester_name},&lt;br&gt;&lt;br&gt; the data request for dataset ${dataset_name} has been rejected by the Data Owner (${dataOwner_name}). Below you can see the reason.</documentation>
      <extensionElements>
        <activiti:formProperty id="comment" name="Comment" type="textarea" writable="false"></activiti:formProperty>
        <activiti:formProperty id="ok" name="OK" type="button"></activiti:formProperty>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow22" sourceRef="exclusivegateway1" targetRef="rejected">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${rdb_option=="Rejected"  && validation_message == ""}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow23" sourceRef="rejected_user_form" targetRef="endevent1"></sequenceFlow>
    <userTask id="data_access_granted" name="Granted Access to Your Data Set" activiti:candidateUsers="user(${dataOwner})">
      <documentation>&lt;br&gt;Dear ${dataOwner_name},&lt;br&gt;&lt;br&gt;${dataRequester_name} requested access to the dataset &lt;b&gt;${dataset_name}&lt;/b&gt;. Given the information provided by ${dataRequester_name} at the time of the access request and listed on this page, access to the data set does not require manual approval steps.</documentation>
      <extensionElements>
        <activiti:formProperty id="ok" name="OK" type="button" required="true"></activiti:formProperty>
      </extensionElements>
    </userTask>
    <scriptTask id="dataSetRequestAccessGateway" name="Data set request access gateway after approval" scriptFormat="groovy" activiti:autoStoreVariables="false">
      <script>import com.collibra.dgc.core.api.model.workflow.WorkflowBusinessItemType

loggerApi.info("&lt;&lt;Data Set request access gateway after approval: start")

def pii_changed = execution.getVariable("pii_changed")
loggerApi.info("--pii_changed:" + pii_changed)

if (pii_changed =="" || !pii_changed)
{
workflowInstanceApi.startWorkflowInstances(builders.get("StartWorkflowInstancesRequest")
	.businessItemIds([newIssueUuid])
	.businessItemType(WorkflowBusinessItemType.valueOf("ASSET"))
	.workflowDefinitionId(workflowDefinitionApi.getWorkflowDefinitionByProcessId("RequestAccessGatewayElsevier").getId())
	.formProperties([requester: requester, dataset_uuid: uuid2String(dataset_uuid), dataset_name: dataset_name, dataRequester_name: dataRequester_name, assetId: uuid2String(newIssueUuid)])
	.build())
}
else
{
	
	def type = "Update"

		
	workflowInstanceApi.startWorkflowInstances(builders.get("StartWorkflowInstancesRequest")
		.businessItemIds([item.id])
		.businessItemType(WorkflowBusinessItemType.valueOf("ASSET"))
		.workflowDefinitionId(workflowDefinitionApi.getWorkflowDefinitionByProcessId("RequestAccessGatewayElsevier").getId())
		.formProperties([requester: requester, dataset_uuid: uuid2String(dataset_uuid), dataset_name: dataset_name, type: type, dataRequester_name: dataRequester_name, assetId: uuid2String(newIssueUuid)])
		.build())
		
}
	

loggerApi.info("&lt;&lt;Data Set request access gateway after approval: end")</script>
    </scriptTask>
    <sequenceFlow id="flow27" sourceRef="dataSetRequestAccessGateway" targetRef="endevent1"></sequenceFlow>
    <scriptTask id="scripttask1" name="Data set request access gateway without approval" scriptFormat="groovy" activiti:autoStoreVariables="false">
      <script>import com.collibra.dgc.core.api.model.workflow.WorkflowBusinessItemType

loggerApi.info("&lt;&lt;Data Set request access gateway without approval: start")

workflowInstanceApi.startWorkflowInstances(builders.get("StartWorkflowInstancesRequest")
	.businessItemIds([newIssueUuid])
	.businessItemType(WorkflowBusinessItemType.valueOf("ASSET"))
	.workflowDefinitionId(workflowDefinitionApi.getWorkflowDefinitionByProcessId("RequestAccessGatewayElsevier").getId())
	.formProperties([requester: requester, dataset_uuid: uuid2String(dataset_uuid), dataset_name: dataset_name, dataRequester_name: dataRequester_name, assetId: uuid2String(newIssueUuid)])
	.build())

loggerApi.info("&lt;&lt;Data Set request access gateway without approval: end")</script>
    </scriptTask>
    <parallelGateway id="parallelgateway1" name="Parallel Gateway"></parallelGateway>
    <sequenceFlow id="flow30" sourceRef="exclusivegateway2" targetRef="parallelgateway1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${!approval_needed && add_access == "add"}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow31" sourceRef="parallelgateway1" targetRef="data_access_granted"></sequenceFlow>
    <sequenceFlow id="flow32" sourceRef="parallelgateway1" targetRef="scripttask1"></sequenceFlow>
    <sequenceFlow id="flow33" sourceRef="data_access_granted" targetRef="endevent2"></sequenceFlow>
    <sequenceFlow id="flow34" sourceRef="scripttask1" targetRef="endevent2"></sequenceFlow>
    <userTask id="approved_user_form" name="Data request approved" activiti:candidateUsers="user(${requester})">
      <documentation>Dear ${dataRequester_name},&lt;br&gt;&lt;br&gt;Your access request to data set &lt;a href=${applicationApi.getInfo().getBaseUrl()}asset/${dataset_uuid}&gt;${dataset_name}&lt;/a&gt; has been approved by the Data Owner (${dataOwner_name}). You will be notified once your access is granted.</documentation>
      <extensionElements>
        <activiti:formProperty id="ok" name="OK" type="button"></activiti:formProperty>
      </extensionElements>
    </userTask>
    <scriptTask id="rejected" name="Rejected" scriptFormat="groovy" activiti:autoStoreVariables="false">
      <script>import java.text.SimpleDateFormat
import java.time.LocalDate
import java.time.ZoneId
import com.collibra.dgc.core.api.dto.instance.asset.ChangeAssetRequest
import com.collibra.dgc.core.api.dto.instance.attribute.AddAttributeRequest
import com.collibra.dgc.core.api.dto.instance.attribute.FindAttributesRequest
import com.collibra.dgc.core.api.dto.instance.attribute.ChangeAttributeRequest


loggerApi.info("&lt;&lt;Access data request - rejected: start")

assetApi.changeAsset(ChangeAssetRequest.builder()
							.id(newIssueUuid)
							.statusId(string2Uuid("00000000-0000-0000-0000-000000005010"))
							.build())

//approval/rejection date in the ticket
loggerApi.info("Init variables: Started")

def zoneId = ZoneId.of("UTC")
def currentDate = LocalDate.now()
def approval_date = currentDate.atStartOfDay(zoneId).toEpochSecond() * 1000

if(!attributeApi.findAttributes(FindAttributesRequest.builder()
										.assetId(newIssueUuid)
										.typeIds([string2Uuid(uuid_dataset_approval_rejection_date)])
										.build()
										).getResults().isEmpty())
		{
		def existingAttributeId = attributeApi.findAttributes(FindAttributesRequest.builder()
															.assetId(newIssueUuid)
															.typeIds([string2Uuid(uuid_dataset_approval_rejection_date)])
															.build()
															).getResults().get(0).getId()
			attributeApi.changeAttribute(ChangeAttributeRequest.builder()
						.id(existingAttributeId)
						.value(approval_date)
						.build())
			}
			else
			{
				attributeApi.addAttribute(AddAttributeRequest.builder()
												.assetId(newIssueUuid)
												.typeId(string2Uuid(uuid_dataset_approval_rejection_date))
												.value(approval_date)
												.build())
																
			}



loggerApi.info("&lt;&lt;Access data request - rejected: end")</script>
    </scriptTask>
    <scriptTask id="Validate_with_request_for_approval" name="validate with request for approval" scriptFormat="groovy" activiti:autoStoreVariables="false">
      <script>import com.collibra.dgc.core.api.model.ResourceType
import com.collibra.dgc.core.api.dto.instance.comment.AddCommentRequest

loggerApi.info("&lt;&lt;validate with request for approval : start")

def validation_message = ""
execution.setVariable("validation_message","")

if(comment.toString() != "")
	{
	commentApi.addComment(AddCommentRequest.builder()
										.baseResourceId(newIssueUuid)
										.baseResourceType(ResourceType.valueOf("Asset"))
										.content(comment.toString())
										.build())
	}

//comment
if (comment.toString() =="" &amp;&amp; rdb_option == "Rejected")
	{
		validation_message = '&lt;b&gt;Note: &lt;br&gt;&lt;/b&gt;&lt;u&gt;Comment&lt;/u&gt; is a mandatory field if you reject the proposal, please fill in a value.&lt;br&gt;'
		execution.setVariable("validation_message",validation_message)
	}

loggerApi.info("&lt;&lt;validate with request for approval : end")</script>
    </scriptTask>
    <sequenceFlow id="flow35" sourceRef="request_for_approval" targetRef="Validate_with_request_for_approval"></sequenceFlow>
    <sequenceFlow id="flow36" sourceRef="Validate_with_request_for_approval" targetRef="exclusivegateway1"></sequenceFlow>
    <sequenceFlow id="flow37" sourceRef="exclusivegateway1" targetRef="request_for_approval">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${validation_message != ""}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow38" sourceRef="approved" targetRef="exclusivegateway3"></sequenceFlow>
    <userTask id="extension_approved_user_form" name="Data extension request approved" activiti:candidateUsers="user(${requester})">
      <documentation>Dear ${dataRequester_name},&lt;br&gt;&lt;br&gt; the data request for dataset ${dataset_name} has been extended by the Data Owner (${dataOwner_name}).</documentation>
      <extensionElements>
        <activiti:formProperty id="ok" name="OK" type="button"></activiti:formProperty>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow41" sourceRef="extension_approved_user_form" targetRef="endevent1"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway4" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow42" sourceRef="rejected" targetRef="exclusivegateway4"></sequenceFlow>
    <sequenceFlow id="flow43" sourceRef="exclusivegateway4" targetRef="rejected_user_form">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${add_access == "add"}]]></conditionExpression>
    </sequenceFlow>
    <userTask id="extension_rejected_user_form" name="Data extension request rejected" activiti:candidateUsers="user(${requester})">
      <documentation>Dear ${dataRequester_name},&lt;br&gt;&lt;br&gt; the data extension request for dataset &lt;a&gt;${dataset_name} has been rejected by the Data Owner (${dataOwner_name}). Below you can see the reason.</documentation>
      <extensionElements>
        <activiti:formProperty id="comment" name="Comment" type="textarea" writable="false"></activiti:formProperty>
        <activiti:formProperty id="ok" name="OK" type="button"></activiti:formProperty>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow45" sourceRef="extension_rejected_user_form" targetRef="endevent1"></sequenceFlow>
    <userTask id="usertask1" name="Data Access Granted" activiti:candidateUsers="user(${dataOwner})">
      <documentation>&lt;br&gt;Dear ${dataOwner_name},&lt;br&gt;&lt;br&gt;${dataRequester_name} requested a data extension to the dataset &lt;b&gt;${dataset_name}&lt;/b&gt;. Given the information provided by ${dataRequester_name} at the time of the access request that is available to you in the ticket,access can be provided without your manual approval..</documentation>
      <extensionElements>
        <activiti:formProperty id="ok" name="OK" type="button" required="true"></activiti:formProperty>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow47" sourceRef="usertask1" targetRef="endevent3"></sequenceFlow>
    <scriptTask id="extend_approval" name="Extend Approval" scriptFormat="groovy" activiti:autoStoreVariables="false">
      <script>import com.collibra.dgc.core.api.dto.instance.asset.ChangeAssetRequest
import com.collibra.dgc.core.api.dto.instance.attribute.FindAttributesRequest
import com.collibra.dgc.core.api.dto.instance.attribute.ChangeAttributeRequest
import com.collibra.dgc.core.api.dto.instance.attribute.AddAttributeRequest

loggerApi.info("&lt;&lt;extend approval: start")

//status
assetApi.changeAsset(ChangeAssetRequest.builder()
	.statusId(string2Uuid("00000000-0000-0000-0000-000000005024")) //access granted
	.id(newIssueUuid)
	.build())

//Add another 90 days after the current end effective date
if(!attributeApi.findAttributes(FindAttributesRequest.builder()
	.assetId(newIssueUuid)
	.typeIds([string2Uuid("00000000-0000-0000-0000-000000000254")]) //end effective date
	.build()
	).getResults().isEmpty())
{
def effective_end_date_attribute_id = attributeApi.findAttributes(FindAttributesRequest.builder()
	.assetId(newIssueUuid)
	.typeIds([string2Uuid("00000000-0000-0000-0000-000000000254")])
	.build()
	).getResults().get(0).getId()

def effective_end_date_attribute_value = attributeApi.findAttributes(FindAttributesRequest.builder()
													.assetId(newIssueUuid)
													.typeIds([string2Uuid("00000000-0000-0000-0000-000000000254")])
													.build()
													).getResults().get(0).getValue()

													
effective_end_date_attribute_value = (effective_end_date_attribute_value + 7776000000).toString()
																												
attributeApi.changeAttribute(ChangeAttributeRequest.builder()
.id(effective_end_date_attribute_id)
.value(effective_end_date_attribute_value)
.build())
}



//extend the number of extensions
//Get the number of extensions and add 1 if it already exists; If not it will become 0
if(!attributeApi.findAttributes(FindAttributesRequest.builder()
										.assetId(newIssueUuid)
										.typeIds([string2Uuid(uuid_nr_of_extensions)])
										.build()
										).getResults().isEmpty())
	{
	def existingAttributeId = attributeApi.findAttributes(FindAttributesRequest.builder()
										.assetId(newIssueUuid)
										.typeIds([string2Uuid(uuid_nr_of_extensions)])
										.build()
										).getResults().get(0).getId()

	def existingAttributeValue = attributeApi.findAttributes(FindAttributesRequest.builder()
		.assetId(newIssueUuid)
		.typeIds([string2Uuid(uuid_nr_of_extensions)])
		.build()
		).getResults().get(0).getValue()
											
		attributeApi.changeAttribute(ChangeAttributeRequest.builder()
									.id(existingAttributeId)
									.value(existingAttributeValue + 1)
									.build())
	}
		else
		{
		attributeApi.addAttribute(AddAttributeRequest.builder()
								.assetId(newIssueUuid)
								.typeId(string2Uuid(uuid_nr_of_extensions))
								.value(0)
								.build())
		}

loggerApi.info("&lt;&lt;Extend approval: end")</script>
    </scriptTask>
    <scriptTask id="extend_approval1" name="Extend approval 1" scriptFormat="groovy" activiti:autoStoreVariables="false">
      <script>import com.collibra.dgc.core.api.dto.instance.asset.ChangeAssetRequest
import com.collibra.dgc.core.api.dto.instance.attribute.FindAttributesRequest
import com.collibra.dgc.core.api.dto.instance.attribute.ChangeAttributeRequest
import com.collibra.dgc.core.api.dto.instance.attribute.AddAttributeRequest


loggerApi.info("&lt;&lt;extend approval: start")

//status
assetApi.changeAsset(ChangeAssetRequest.builder()
	.statusId(string2Uuid("00000000-0000-0000-0000-000000005024")) //access granted
	.id(newIssueUuid)
	.build())

//Add another 90 days after the current end effective date
if(!attributeApi.findAttributes(FindAttributesRequest.builder()
	.assetId(newIssueUuid)
	.typeIds([string2Uuid("00000000-0000-0000-0000-000000000254")]) //end effective date
	.build()
	).getResults().isEmpty())
{
def effective_end_date_attribute_id = attributeApi.findAttributes(FindAttributesRequest.builder()
	.assetId(newIssueUuid)
	.typeIds([string2Uuid("00000000-0000-0000-0000-000000000254")])
	.build()
	).getResults().get(0).getId()

def effective_end_date_attribute_value = attributeApi.findAttributes(FindAttributesRequest.builder()
													.assetId(newIssueUuid)
													.typeIds([string2Uuid("00000000-0000-0000-0000-000000000254")])
													.build()
													).getResults().get(0).getValue()

													
effective_end_date_attribute_value = (effective_end_date_attribute_value + 7776000000).toString()
																												
attributeApi.changeAttribute(ChangeAttributeRequest.builder()
.id(effective_end_date_attribute_id)
.value(effective_end_date_attribute_value)
.build())
}



//extend the number of extensions
//Get the number of extensions and add 1 if it already exists; If not it will become 0
if(!attributeApi.findAttributes(FindAttributesRequest.builder()
										.assetId(newIssueUuid)
										.typeIds([string2Uuid(uuid_nr_of_extensions)])
										.build()
										).getResults().isEmpty())
	{
	def existingAttributeId = attributeApi.findAttributes(FindAttributesRequest.builder()
										.assetId(newIssueUuid)
										.typeIds([string2Uuid(uuid_nr_of_extensions)])
										.build()
										).getResults().get(0).getId()

	def existingAttributeValue = attributeApi.findAttributes(FindAttributesRequest.builder()
		.assetId(newIssueUuid)
		.typeIds([string2Uuid(uuid_nr_of_extensions)])
		.build()
		).getResults().get(0).getValue()
											
		attributeApi.changeAttribute(ChangeAttributeRequest.builder()
									.id(existingAttributeId)
									.value(existingAttributeValue + 1)
									.build())
	}
		else
		{
		attributeApi.addAttribute(AddAttributeRequest.builder()
								.assetId(newIssueUuid)
								.typeId(string2Uuid(uuid_nr_of_extensions))
								.value(0)
								.build())
		}

loggerApi.info("&lt;&lt;Extend approval: end")</script>
    </scriptTask>
    <sequenceFlow id="flow51" sourceRef="extend_approval1" targetRef="extension_approved_user_form"></sequenceFlow>
    <scriptTask id="extend_approval_3" name="Extend Approval" scriptFormat="groovy" activiti:autoStoreVariables="false">
      <script>import com.collibra.dgc.core.api.dto.instance.asset.ChangeAssetRequest


loggerApi.info("&lt;&lt;extend approva3l: start")

//status
assetApi.changeAsset(ChangeAssetRequest.builder()
	.statusId(string2Uuid("00000000-0000-0000-0000-000000005024")) //access granted
	.id(newIssueUuid)
	.build())


loggerApi.info("&lt;&lt;Extend approval3: end")</script>
    </scriptTask>
    <sequenceFlow id="flow52" sourceRef="exclusivegateway4" targetRef="extend_approval_3">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${add_access == "skip"}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow53" sourceRef="extend_approval_3" targetRef="extension_rejected_user_form"></sequenceFlow>
    <sequenceFlow id="flow54" sourceRef="exclusivegateway2" targetRef="extend_approval">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${!approval_needed && add_access == "skip"}]]></conditionExpression>
    </sequenceFlow>
    <parallelGateway id="parallelgateway2" name="Parallel Gateway"></parallelGateway>
    <sequenceFlow id="flow58" sourceRef="parallelgateway2" targetRef="approved_user_form"></sequenceFlow>
    <sequenceFlow id="flow59" sourceRef="parallelgateway2" targetRef="dataSetRequestAccessGateway"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway3" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow50" sourceRef="exclusivegateway3" targetRef="extend_approval1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${add_access == "skip" && pii_changed == ""}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow57" sourceRef="exclusivegateway3" targetRef="parallelgateway2">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${add_access == "add" || pii_changed == "changed"}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow60" sourceRef="approved_user_form" targetRef="endevent1"></sequenceFlow>
    <sequenceFlow id="flow61" sourceRef="extend_approval" targetRef="usertask1"></sequenceFlow>
    <endEvent id="endevent3" name="End"></endEvent>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_Collaboration">
    <bpmndi:BPMNPlane bpmnElement="Collaboration" id="BPMNPlane_Collaboration">
      <bpmndi:BPMNShape bpmnElement="data_request_ticket_approval_workflow" id="BPMNShape_data_request_ticket_approval_workflow">
        <omgdc:Bounds height="491.0" width="1351.0" x="110.0" y="320.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="lane1" id="BPMNShape_lane1">
        <omgdc:Bounds height="491.0" width="1331.0" x="130.0" y="320.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startevent1" id="BPMNShape_startevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="150.0" y="370.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent1" id="BPMNShape_endevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="1400.0" y="370.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="approved" id="BPMNShape_approved">
        <omgdc:Bounds height="55.0" width="105.0" x="860.0" y="463.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway1" id="BPMNShape_exclusivegateway1">
        <omgdc:Bounds height="40.0" width="40.0" x="800.0" y="367.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="request_for_approval" id="BPMNShape_request_for_approval">
        <omgdc:Bounds height="55.0" width="105.0" x="550.0" y="360.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="reset_status" id="BPMNShape_reset_status">
        <omgdc:Bounds height="55.0" width="105.0" x="330.0" y="360.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="init_variables" id="BPMNShape_init_variables">
        <omgdc:Bounds height="55.0" width="105.0" x="200.0" y="360.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway2" id="BPMNShape_exclusivegateway2">
        <omgdc:Bounds height="40.0" width="40.0" x="470.0" y="367.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent2" id="BPMNShape_endevent2">
        <omgdc:Bounds height="35.0" width="35.0" x="365.0" y="700.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="rejected_user_form" id="BPMNShape_rejected_user_form">
        <omgdc:Bounds height="55.0" width="105.0" x="1080.0" y="617.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="data_access_granted" id="BPMNShape_data_access_granted">
        <omgdc:Bounds height="55.0" width="105.0" x="220.0" y="597.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="dataSetRequestAccessGateway" id="BPMNShape_dataSetRequestAccessGateway">
        <omgdc:Bounds height="101.0" width="105.0" x="1156.0" y="337.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask1" id="BPMNShape_scripttask1">
        <omgdc:Bounds height="91.0" width="105.0" x="438.0" y="579.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="parallelgateway1" id="BPMNShape_parallelgateway1">
        <omgdc:Bounds height="40.0" width="40.0" x="362.0" y="490.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="approved_user_form" id="BPMNShape_approved_user_form">
        <omgdc:Bounds height="55.0" width="105.0" x="1156.0" y="463.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="rejected" id="BPMNShape_rejected">
        <omgdc:Bounds height="55.0" width="105.0" x="860.0" y="617.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Validate_with_request_for_approval" id="BPMNShape_Validate_with_request_for_approval">
        <omgdc:Bounds height="94.0" width="105.0" x="680.0" y="341.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="extension_approved_user_form" id="BPMNShape_extension_approved_user_form">
        <omgdc:Bounds height="81.0" width="105.0" x="1240.0" y="537.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway4" id="BPMNShape_exclusivegateway4">
        <omgdc:Bounds height="40.0" width="40.0" x="1000.0" y="624.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="extension_rejected_user_form" id="BPMNShape_extension_rejected_user_form">
        <omgdc:Bounds height="81.0" width="105.0" x="1270.0" y="707.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask1" id="BPMNShape_usertask1">
        <omgdc:Bounds height="55.0" width="105.0" x="620.0" y="620.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="extend_approval" id="BPMNShape_extend_approval">
        <omgdc:Bounds height="55.0" width="105.0" x="620.0" y="543.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="extend_approval1" id="BPMNShape_extend_approval1">
        <omgdc:Bounds height="55.0" width="105.0" x="1080.0" y="550.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="extend_approval_3" id="BPMNShape_extend_approval_3">
        <omgdc:Bounds height="55.0" width="105.0" x="1090.0" y="720.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="parallelgateway2" id="BPMNShape_parallelgateway2">
        <omgdc:Bounds height="40.0" width="40.0" x="1060.0" y="470.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway3" id="BPMNShape_exclusivegateway3">
        <omgdc:Bounds height="40.0" width="40.0" x="1000.0" y="470.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent3" id="BPMNShape_endevent3">
        <omgdc:Bounds height="35.0" width="35.0" x="655.0" y="700.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="flow11" id="BPMNEdge_flow11">
        <omgdi:waypoint x="185.0" y="387.0"></omgdi:waypoint>
        <omgdi:waypoint x="200.0" y="387.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow12" id="BPMNEdge_flow12">
        <omgdi:waypoint x="305.0" y="387.0"></omgdi:waypoint>
        <omgdi:waypoint x="330.0" y="387.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow13" id="BPMNEdge_flow13">
        <omgdi:waypoint x="435.0" y="387.0"></omgdi:waypoint>
        <omgdi:waypoint x="470.0" y="387.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow14" id="BPMNEdge_flow14">
        <omgdi:waypoint x="510.0" y="387.0"></omgdi:waypoint>
        <omgdi:waypoint x="550.0" y="387.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow18" id="BPMNEdge_flow18">
        <omgdi:waypoint x="820.0" y="407.0"></omgdi:waypoint>
        <omgdi:waypoint x="820.0" y="490.0"></omgdi:waypoint>
        <omgdi:waypoint x="860.0" y="490.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow22" id="BPMNEdge_flow22">
        <omgdi:waypoint x="820.0" y="407.0"></omgdi:waypoint>
        <omgdi:waypoint x="819.0" y="648.0"></omgdi:waypoint>
        <omgdi:waypoint x="860.0" y="644.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow23" id="BPMNEdge_flow23">
        <omgdi:waypoint x="1185.0" y="644.0"></omgdi:waypoint>
        <omgdi:waypoint x="1417.0" y="647.0"></omgdi:waypoint>
        <omgdi:waypoint x="1417.0" y="405.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow27" id="BPMNEdge_flow27">
        <omgdi:waypoint x="1261.0" y="387.0"></omgdi:waypoint>
        <omgdi:waypoint x="1400.0" y="387.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow30" id="BPMNEdge_flow30">
        <omgdi:waypoint x="490.0" y="407.0"></omgdi:waypoint>
        <omgdi:waypoint x="382.0" y="490.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow31" id="BPMNEdge_flow31">
        <omgdi:waypoint x="362.0" y="510.0"></omgdi:waypoint>
        <omgdi:waypoint x="272.0" y="510.0"></omgdi:waypoint>
        <omgdi:waypoint x="272.0" y="597.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow32" id="BPMNEdge_flow32">
        <omgdi:waypoint x="402.0" y="510.0"></omgdi:waypoint>
        <omgdi:waypoint x="490.0" y="510.0"></omgdi:waypoint>
        <omgdi:waypoint x="490.0" y="579.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow33" id="BPMNEdge_flow33">
        <omgdi:waypoint x="272.0" y="652.0"></omgdi:waypoint>
        <omgdi:waypoint x="272.0" y="717.0"></omgdi:waypoint>
        <omgdi:waypoint x="365.0" y="717.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow34" id="BPMNEdge_flow34">
        <omgdi:waypoint x="490.0" y="670.0"></omgdi:waypoint>
        <omgdi:waypoint x="490.0" y="717.0"></omgdi:waypoint>
        <omgdi:waypoint x="400.0" y="717.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow35" id="BPMNEdge_flow35">
        <omgdi:waypoint x="655.0" y="387.0"></omgdi:waypoint>
        <omgdi:waypoint x="680.0" y="388.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow36" id="BPMNEdge_flow36">
        <omgdi:waypoint x="785.0" y="388.0"></omgdi:waypoint>
        <omgdi:waypoint x="800.0" y="387.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow37" id="BPMNEdge_flow37">
        <omgdi:waypoint x="820.0" y="367.0"></omgdi:waypoint>
        <omgdi:waypoint x="821.0" y="328.0"></omgdi:waypoint>
        <omgdi:waypoint x="601.0" y="328.0"></omgdi:waypoint>
        <omgdi:waypoint x="602.0" y="360.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow38" id="BPMNEdge_flow38">
        <omgdi:waypoint x="965.0" y="490.0"></omgdi:waypoint>
        <omgdi:waypoint x="1000.0" y="490.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow41" id="BPMNEdge_flow41">
        <omgdi:waypoint x="1345.0" y="577.0"></omgdi:waypoint>
        <omgdi:waypoint x="1417.0" y="577.0"></omgdi:waypoint>
        <omgdi:waypoint x="1417.0" y="405.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow42" id="BPMNEdge_flow42">
        <omgdi:waypoint x="965.0" y="644.0"></omgdi:waypoint>
        <omgdi:waypoint x="1000.0" y="644.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow43" id="BPMNEdge_flow43">
        <omgdi:waypoint x="1040.0" y="644.0"></omgdi:waypoint>
        <omgdi:waypoint x="1080.0" y="644.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow45" id="BPMNEdge_flow45">
        <omgdi:waypoint x="1375.0" y="747.0"></omgdi:waypoint>
        <omgdi:waypoint x="1417.0" y="748.0"></omgdi:waypoint>
        <omgdi:waypoint x="1417.0" y="405.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow47" id="BPMNEdge_flow47">
        <omgdi:waypoint x="672.0" y="675.0"></omgdi:waypoint>
        <omgdi:waypoint x="672.0" y="700.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow51" id="BPMNEdge_flow51">
        <omgdi:waypoint x="1185.0" y="577.0"></omgdi:waypoint>
        <omgdi:waypoint x="1240.0" y="577.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow52" id="BPMNEdge_flow52">
        <omgdi:waypoint x="1020.0" y="664.0"></omgdi:waypoint>
        <omgdi:waypoint x="1020.0" y="747.0"></omgdi:waypoint>
        <omgdi:waypoint x="1090.0" y="747.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow53" id="BPMNEdge_flow53">
        <omgdi:waypoint x="1195.0" y="747.0"></omgdi:waypoint>
        <omgdi:waypoint x="1270.0" y="747.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow54" id="BPMNEdge_flow54">
        <omgdi:waypoint x="490.0" y="407.0"></omgdi:waypoint>
        <omgdi:waypoint x="672.0" y="543.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow58" id="BPMNEdge_flow58">
        <omgdi:waypoint x="1100.0" y="490.0"></omgdi:waypoint>
        <omgdi:waypoint x="1156.0" y="490.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow59" id="BPMNEdge_flow59">
        <omgdi:waypoint x="1080.0" y="470.0"></omgdi:waypoint>
        <omgdi:waypoint x="1080.0" y="388.0"></omgdi:waypoint>
        <omgdi:waypoint x="1156.0" y="387.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow50" id="BPMNEdge_flow50">
        <omgdi:waypoint x="1020.0" y="510.0"></omgdi:waypoint>
        <omgdi:waypoint x="1019.0" y="577.0"></omgdi:waypoint>
        <omgdi:waypoint x="1080.0" y="577.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow57" id="BPMNEdge_flow57">
        <omgdi:waypoint x="1040.0" y="490.0"></omgdi:waypoint>
        <omgdi:waypoint x="1060.0" y="490.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow60" id="BPMNEdge_flow60">
        <omgdi:waypoint x="1208.0" y="463.0"></omgdi:waypoint>
        <omgdi:waypoint x="1417.0" y="405.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow61" id="BPMNEdge_flow61">
        <omgdi:waypoint x="672.0" y="598.0"></omgdi:waypoint>
        <omgdi:waypoint x="672.0" y="620.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>